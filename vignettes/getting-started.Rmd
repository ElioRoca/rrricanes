---
title: "Getting Started"
author: "Tim Trice"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting Started}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r}
library(dplyr)
library(Hurricanes)
```

## General Introduction

`rrricanes` is intended to give easy access to hurricane archives. In short, it is a web-scraping tool that parses the National Hurricane Center's (NHC) archives to get storm data. 

At this point, data is only available back to 1998. 

There are two basins which data is available: north Atlantic ("AL") and northeastern Pacific ("EP"). The northeastern Pacific basin typically covers from the west coast of North America to -140&deg; longitude (140&deg;W). The Central Pacific Hurricane Center (CPHC) covers the north Pacific from -140&deg; to -180&deg;. 

The NHC will stop issuing advisories once a storm crosses -140&deg; where the CPHC takes over. However, I cannot rule out that some storms that have crossed this "boundary" or even developed in CPHC waters will not exist in records retrieved.

On a semi-related note. In some instances (such as Hurricane Otto, 2016) a storm may cross from the Atlantic to Pacific ocean (and even vice versa, though rare). When this happens the storm is given a new name once it emerges into the Pacific ocean. However, if a storm crosses -140&deg; longitude it retains it's name.

Lastly, it is possible a storm will develop at the end of the year and continue to exist into the next year. I am not aware if those storms will exist in this package as of this time. However, generally the storm should be listed in the archives of the year it developed. 

## Get Storms

By default, `get_storms` will return all storms that have developed for the current year in both basins. If no storms have developed, an error will be generated. For this example, we'll use 2016.

```{r get.storms}
al.2016 <- get_storms(year = 2016, basin = "AL") %>% tbl_df %>% print(n = nrow(.))
```

You can also gather multiple years.

```{r get.storms.multi.years, eval = FALSE}
get_storms(year = 2014:2015, basin = "EP")
```

## Getting Storm Data

`get_storm_data` can be used to retrieve one or multiple products for a specific cyclone. 

Load forecast/advisory data for Hurricane Hermine:

```{r}
url <- al.2016 %>% filter(Name == "Hurricane Hermine") %>% .$Link
get_storm_data("fstadv", link = url)
```

This call brings a dataframe to the global environment: `fstadv`:

```{r}
head(fstadv)
```

We can get the forecast/advisory data and wind speed probabilities at once:

```{r}
get_storm_data("fstadv", "wndprb", link = url)
```

We now have two dataframes in our global environment: `fstadv` and `wndprb`.

```{r}
dim(fstadv)
```

```{r}
dim(wndprb)
```

You can pass preferred values for names of each dataframe returned.

```{r}
get_storm_data("fstadv", "wndprb",
               names = list("fstadv" = "al.09.2016.fstadv",
                            "wndprb" = "al.09.2016.wndprb"),
               link = url)
```

```{r}
dim(al.09.2016.fstadv)
```

```{r}
dim(al.09.2016.wndprb)
```

## Forecast/Advisory Product (`fstadv`)

The core of a storm's dataset is located in the Forecast/Advisory product. This product contains current location, forecast position, movement and structural detail of the cyclone. 

```{r}
al.09.2016 <- get_fstadv(link = url)
```

## Strike Probabilities (`prblty`)

Strike probabilities were discontinued after the 2005 hurricane season. For this example, we'll look at Hurricane Katrina. For this we use the function `get_prblty`.

```{r}
al.2005 <- get_storms(year = 2005, basin = "AL")

url <- al.2005 %>% filter(Name == "Hurricane Katrina") %>% .$Link

al.12.2016.prblty <- get_prblty(link = url)
```

```{r}
str(al.12.2016.prblty)
```

This dataframe contains the possibility of a cyclone passing within 65 nautical miles of `Location`. The variables `A`, `B`, `C`, `D`, and `E` are as they appear in the products and were left as-is to avoid confusion. They're definition is as follows:

* `A` - current through 12 hours.
* `B` - within the next 12-24 hours
* `C` - within the next 24-36 hours
* `D` - within the next 36-48 hours
* `E` - Total probability from current through 48 hours. 

Many values in the text product may be "X" for less than 1% chance of a strike. These values are converted to 0 as the fields are numeric. 

The strike probability products did not contain `Key` which is the unique identifier for every cyclone. So the best way to do any joins will be by `Name`, `Adv` and `Date`.

Strike Probabilities may not exist for most Pacific cyclones.

## Wind Speed Probabilities (`wndprb`)

```{r}
url <- al.2016 %>% filter(Name == "Hurricane Hermine") %>% .$Link
al.09.2016.wndprb <- get_wndprb(link = url)
```

```{r}
str(al.09.2016.wndprb)
```

Wind Speed Probabilities are a bit more advanced than their predecessor. The `Wind` variable is for 34kt, 50kt and 64kt winds expected within a specific time period. 

Each consecutive variable is within a specific time-frame (12, 24, 36, 48, 72, 96 and 120 hours) for both that time frame and cumulative.

For example, `Wind24` is the chance of `Wind` between 12-24 hours. `Wind24Cum` is the cumulative probability from `Date` through 24 hours. 

As with strike probabilities, an "X" in the original text product meant less than 0.5% chance for the specified wind in the specified time period. "X" has been replaced by 0 in this package.

Strike Probabilities may not exist for most Pacific cyclones.

See [Tropical Cyclone Wind Speed Probabilities Products](http://www.nhc.noaa.gov/about/pdf/About_Windspeed_Probabilities.pdf) for more information.

## Other products

Other products are available:

* `get_public` for Public Advisory statements. Think general information for the public audience. May not exist for some Pacific cyclones. Additionally, when watches and warnings are issued, these are issued every 3 hours (and, in some cases, every two).

* `get_discus` for Storm Discussions. These are more technical statements on the structure of a storm, forecast model tendencies and satellite presentation.

* `get_update` These are brief update statements when something considerable has changed in the cyclone or if the cyclone is making landfall.

* `get_posest`. Position estimates are generally issued when a storm is making landfall and may be issued hourly. 

Hurricane Ike, 2008, has both updates and position estimates. 

At this time none of these products are parsed. Only the content of the product is returned.
